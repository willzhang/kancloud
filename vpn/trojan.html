<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>trojan - willblog</title>
    
    
        <script src="../asset/theme.js"></script>
    
</head>
<body>
<div id="root"></div>
<script type="application/payload+json">
{"book":{"id":"q5wy4m"},"summary":[{"title":"","articles":[{"title":"前言","ref":"README.md","path":"README.html","children":[]},{"title":"VPN教程","ref":"vpn\/README.md","path":"vpn\/README.html","children":[{"title":"trojan","ref":"vpn\/trojan.md","path":"vpn\/trojan.html","children":[]},{"title":"v2ray","ref":"vpn\/v2ray.md","path":"vpn\/v2ray.html","children":[]},{"title":"pptp","ref":"vpn\/pptp.md","path":"vpn\/pptp.html","children":[]},{"title":"l2tp","ref":"vpn\/l2tp.md","path":"vpn\/l2tp.html","children":[]},{"title":"fpr","ref":"fpr.md","path":"fpr.html","children":[]},{"title":"kcptun","ref":"vpn\/kcptun.md","path":"vpn\/kcptun.html","children":[]},{"title":"proxifier","ref":"vpn\/proxifier.md","path":"vpn\/proxifier.html","children":[]},{"title":"goproxy","ref":"vpn\/goproxy.md","path":"vpn\/goproxy.html","children":[]},{"title":"docker安装ssr","ref":"vpn\/docker.md","path":"vpn\/docker.html","children":[]},{"title":"shadowsocks","ref":"vpn\/shadowsocks.md","path":"vpn\/shadowsocks.html","children":[]},{"title":"clash","ref":"vpn\/clash.md","path":"vpn\/clash.html","children":[]},{"title":"openvpn","ref":"vpn\/openvpn.md","path":"vpn\/openvpn.html","children":[]},{"title":"vpn代理","ref":"vpn\/proxy.md","path":"vpn\/proxy.html","children":[]}]},{"title":"常用工具","ref":"tools\/README.md","path":"tools\/README.html","children":[{"title":"natapp","ref":"tools\/natapp.md","path":"tools\/natapp.html","children":[]},{"title":"brook","ref":"tools\/brook.md","path":"tools\/brook.html","children":[]},{"title":"ngrok","ref":"tools\/ngrok.md","path":"tools\/ngrok.html","children":[]},{"title":" go-socks5-proxy","ref":"tools\/ go-socks5-proxy.md","path":"tools\/-go-socks5-proxy.html","children":[]},{"title":"proxychains-ng","ref":"tools\/proxychains-ng.md","path":"tools\/proxychains-ng.html","children":[]}]}]}],"config":{"title":"willblog","root":"\/","plugins":["lunrjs","highlight","upyun"],"pluginsConfig":{"theme-classic":{"navs":[{"title":"test","url":"test.com"},{"title":"tes1","url":"test1.com"}]}}},"file":{"path":"vpn\/trojan.html","content":"## trojan简介\n\n一般的科学上网采用强加密和随机混淆来欺骗GFW的过滤机制。然而，Trojan采用最常见的协议HTTPS，以诱骗GFW认为它是HTTPS。当Trojan客户端连接到服务器时，它首先执行真正的 TLS握手。如果握手成功，则所有后续流量都将受到保护TLS; 否则，服务器将立即关闭连接，就像任何HTTPS服务器一样。Trojan反侦查采用主动检测与被动检测，\n\n主动检测：没有正确结构和密码的所有连接将被重定向到预设端点，因此HTTP如果可疑探针连接（或者只是您连接到博客XD的粉丝），则特洛伊木马服务器的行为与该端点完全相同（默认情况下）。\n\n被动检测：由于流量受到保护TLS（用户有责任使用有效证书），如果您正在访问某个HTTP站点，则流量看起来与HTTPS（握手RTT后只有一个TLS）相同; 如果您没有访问某个HTTP站点，那么流量看起来就像HTTPS保持活动一样WebSocket。因此，木马也可以绕过ISP QoS限制。 理论上来说，Trojan可以永久地穿越Great FireWall，而不会被识别出来。\n\ngithub地址： <https:\/\/github.com\/trojan-gfw\/trojan>\n\n官方文档：<https:\/\/trojan-gfw.github.io\/trojan\/>\n\ndocker镜像：<https:\/\/hub.docker.com\/r\/trojangfw\/trojan>\n\n## 部署trojan\n\n创建目录，申请并上传证书到该目录下\n\n```\nmkdir \/etc\/trojan-go && cd \/etc\/trojan-go\n```\n\n创建配置文件：\n\n```json\n# vi config.json\n\n{\n    \"run_type\": \"server\",\n    \"local_addr\": \"0.0.0.0\",\n    \"local_port\": 443,\n    \"remote_addr\": \"127.0.0.1\",\n    \"remote_port\": 80,\n    \"password\": [\n        \"123456\"\n    ],\n    \"ssl\": {\n        \"cert\": \"\/etc\/trojan-go\/willzhangcloud.com_chain.crt\",\n        \"key\": \"\/etc\/trojan-go\/willzhangcloud.com_key.key\",\n        \"sni\": \"willzhangcloud.com\"\n    }\n}\n```\n\n运行nginx容器\n\n```docker\ndocker run -d --restart always \\\n  --name nginx \\\n  -p 80:80 \\\n  nginx \n```\n\n运行trojan容器\n\n```docker\ndocker run -d --restart always \\\n  -p 443:443 \\\n  --name trojan-go \\\n  --restart=always \\\n  -v \/etc\/trojan-go:\/etc\/trojan-go \\\n  teddysun\/trojan-go\n```\n\n下载windows客户端：<https:\/\/github.com\/trojan-gfw\/trojan\/releases>\n\n修改config.json配置文件格式如下：\n\n```json\n{\n    \"run_type\": \"client\",\n    \"local_addr\": \"127.0.0.1\",\n    \"local_port\": 1081,\n    \"remote_addr\": \"willzhangcloud.com\",\n    \"remote_port\": 443,\n    \"password\": [\n        \"123456\"\n    ],\n    \"log_level\": 1,\n    \"ssl\": {\n        \"verify\": true,\n        \"verify_hostname\": true,\n        \"cert\": \"\",\n        \"cipher\": \"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:AES128-SHA:AES256-SHA:DES-CBC3-SHA\",\n        \"cipher_tls13\": \"TLS_AES_128_GCM_SHA256:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_256_GCM_SHA384\",\n        \"sni\": \"willzhangcloud.com\",\n        \"alpn\": [\n            \"h2\",\n            \"http\/1.1\"\n        ],\n        \"reuse_session\": true,\n        \"session_ticket\": false,\n        \"curves\": \"\"\n    },\n    \"tcp\": {\n        \"no_delay\": true,\n        \"keep_alive\": true,\n        \"reuse_port\": false,\n        \"fast_open\": false,\n        \"fast_open_qlen\": 20\n    }\n}\n```\n\n说明：此处需要修改一下”remote_addr”为你的域名，还有设置的password。配置好后，启动trojan。\n\n改好后保存并关闭文件，双击文件夹内的 trojan.exe 文件，trojan程序运行，出现如下黑窗口：\n\n与SS\/SSR\/v2ray等客户端不同，trojan运行出现上述界面后，浏览器无法直接上外网，需要进行额外的设置。本文介绍两种方式：1. 设置系统代理；2. 借助v2rayN。\n\n借助v2rayN上网\n\n设置系统代理方式不能方便的切换pac和全局模式，本节介绍使用v2rayN客户端达到灵活上外网。\n\n1\\. 从 v2ray客户端 下载v2rayN，解压进入v2rayN-Core文件夹。双击文件夹内的 v2rayN.exe 启动，在桌面右下角找到v2rayN的图标（logo是V），双击打开配置界面，按下图添加socks5服务器：\n\n![](..\/images\/screenshot\\_1625804751975.png)\n\n## 申请免费ssl证书\n\nfreessl:\n\n<https:\/\/freessl.cn\/>\n\n![](..\/images\/screenshot\\_1625804841572.png)\n\n根据提示，本地安装KeyManager\n\ngodaddy添加TXT类型记录\n\n![](..\/images\/screenshot\\_1625804865277.png)\n\n域名验证\n\n![](..\/images\/screenshot\\_1625804880725.png)\n","meta":{"mtime":""}},"options":{}}
</script>

<script src="https://jsdelivr.topthink.com/npm/lodash@4.17/lodash.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react@17/umd/react.production.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react-dom@17/umd/react-dom.production.min.js"></script>

<script src="../asset/index.js"></script>

<script src="../asset/plugins/highlight/index.js"></script>

<script src="../asset/plugins/lunrjs/index.js"></script>

<script src="../asset/plugins/theme-default/index.js"></script>

<script type="text/javascript">
    TopWrite.bootstrap();
</script>
</body>
</html>

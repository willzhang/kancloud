<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>linux安装kubernetes - willblog</title>
    
    
        <script src="../asset/theme.js"></script>
    
</head>
<body>
<div id="root"></div>
<script type="application/payload+json">
{"book":{"id":"q5wy4m"},"summary":[{"title":"","articles":[{"title":"前言","ref":"README.md","path":"README.html","children":[]},{"title":"VPN教程","ref":"vpn\/README.md","path":"vpn\/README.html","children":[{"title":"trojan","ref":"vpn\/trojan.md","path":"vpn\/trojan.html","children":[]},{"title":"v2ray","ref":"vpn\/v2ray.md","path":"vpn\/v2ray.html","children":[]},{"title":"pptp","ref":"vpn\/pptp.md","path":"vpn\/pptp.html","children":[]},{"title":"l2tp","ref":"vpn\/l2tp.md","path":"vpn\/l2tp.html","children":[]},{"title":"fpr","ref":"fpr.md","path":"fpr.html","children":[]},{"title":"kcptun","ref":"vpn\/kcptun.md","path":"vpn\/kcptun.html","children":[]},{"title":"proxifier","ref":"vpn\/proxifier.md","path":"vpn\/proxifier.html","children":[]},{"title":"goproxy","ref":"vpn\/goproxy.md","path":"vpn\/goproxy.html","children":[]},{"title":"docker安装ssr","ref":"vpn\/docker.md","path":"vpn\/docker.html","children":[]},{"title":"shadowsocks","ref":"vpn\/shadowsocks.md","path":"vpn\/shadowsocks.html","children":[]},{"title":"clash","ref":"vpn\/clash.md","path":"vpn\/clash.html","children":[]},{"title":"openvpn","ref":"vpn\/openvpn.md","path":"vpn\/openvpn.html","children":[]},{"title":"vpn代理","ref":"vpn\/proxy.md","path":"vpn\/proxy.html","children":[]}]},{"title":"常用工具","ref":"tools\/README.md","path":"tools\/README.html","children":[{"title":"natapp","ref":"tools\/natapp.md","path":"tools\/natapp.html","children":[]},{"title":"brook","ref":"tools\/brook.md","path":"tools\/brook.html","children":[]},{"title":"ngrok","ref":"tools\/ngrok.md","path":"tools\/ngrok.html","children":[]},{"title":" go-socks5-proxy","ref":"tools\/ go-socks5-proxy.md","path":"tools\/-go-socks5-proxy.html","children":[]},{"title":"proxychains-ng","ref":"tools\/proxychains-ng.md","path":"tools\/proxychains-ng.html","children":[]}]},{"title":"博客文章","ref":"blogs\/README.md","path":"blogs\/README.html","children":[{"title":"linux安装mysql","ref":"blogs\/mysql.md","path":"blogs\/mysql.html","children":[]},{"title":"linux安装docker","ref":"blogs\/docker.md","path":"blogs\/docker.html","children":[]},{"title":"linux安装openjdk","ref":"blogs\/openjdk.md","path":"blogs\/openjdk.html","children":[]},{"title":"linux安装kubernetes","ref":"blogs\/kubernetes.md","path":"blogs\/kubernetes.html","children":[]}]}]}],"config":{"theme":"maxime","title":"willblog","root":"\/","plugins":["lunrjs","highlight"],"pluginsConfig":{"theme-classic":{"navs":[{"title":"test","url":"test.com"},{"title":"tes1","url":"test1.com"}]}}},"file":{"path":"blogs\/kubernetes.html","content":"## kubesphere简介\n\nKubeSphere是一个以应用为中心的容器平台，完全开源，KubeSphere 帮助企业在云、虚拟化及物理机等任何环境中快速构建、部署和运维基于 Kubernetes 的容器架构，轻松实现微服务治理、多租户管理、DevOps 与 CI\/CD、监控日志告警、应用商店、大数据、以及人工智能等业务场景。\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/20200421180455562.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70)\n官网：[https:\/\/kubesphere.io\/](https:\/\/kubesphere.io\/)\n\n项目地址：[https:\/\/github.com\/kubesphere\/kubesphere](https:\/\/github.com\/kubesphere\/kubesphere)\n\n## kubesphere部署方式\nkubesphere大致有2种部署方式：\n\n - 部署k8s集群及kubesphere\n - 已有kubernetes集群部署kubesphere\n\n已有k8s集群部署kubesphere具有更高的灵活性，下面演示单独部署k8s集群，并在集群上部署kubesphere。使用rancher开源的云原生分布式存储longhorn作为底层存储。\n\n## 部署k8s集群\n使用sealos工具部署k8s集群，准备4个节点，3个master，1个node，所有节点必须配置主机名，并确认节点时间同步\n```shell\nhostnamectl set-hostname xx\nyum install -y chrony\nsystemctl enable --now chronyd\ntimedatectl set-timezone Asia\/Shanghai\n```\n在第一个master节点操作，下载部署工具及离线包\n```shell\n#基于go的二进制安装程序\nwget -c https:\/\/sealyun.oss-cn-beijing.aliyuncs.com\/latest\/sealos && \\\n    chmod +x sealos && mv sealos \/usr\/bin\n\n# 以k8s v1.18.8为例，不建议使用v1.19.x,kubesphere暂不支持\nwget -c https:\/\/sealyun.oss-cn-beijing.aliyuncs.com\/cd3d5791b292325d38bbfaffd9855312-1.18.8\/kube1.18.8.tar.gz\n```\n执行以下命令部署集群，passwd为所有节点root密码\n```shell\nsealos init --passwd 123456 \\\n  --master 10.39.140.248 \\\n  --master 10.39.140.249 \\\n  --master 10.39.140.250 \\\n  --node 10.39.140.251 \\\n  --pkg-url kube1.18.8.tar.gz \\\n  --version v1.18.8\n```\n确认k8s集群运行正常\n```shell\n# kubectl get nodes\nNAME          STATUS   ROLES    AGE   VERSION\nk8s-master1   Ready    master   13h   v1.18.8\nk8s-master2   Ready    master   13h   v1.18.8\nk8s-master3   Ready    master   13h   v1.18.8\nk8s-node1     Ready    <none>   13h   v1.18.8\n```\n## 部署longhorn存储\n\nlonghorn推荐单独挂盘作为存储使用，这里作为测试直接使用本地存储目录\/data\/longhorn，默认为\/var\/lib\/longhorn。\n\n注意，kubesphere有几个组件申请的pv大小为20G，确保节点空间充足，否则可能出现pv能够绑定成功但没有满足条件的节点可调度的情况。如果仅仅测试环境，可以提前修改cluster-configuration.yaml缩减pv大小。\n\n安装具有3数据副本的longhorn至少需要3个节点，这里去除master节点污点使其可调度pod：\n\n```shell\nkubectl taint nodes --all node-role.kubernetes.io\/master-  \n```\n\nk8s-master1安装helm\n```shell\nversion=v3.3.1\ncurl -LO https:\/\/repo.huaweicloud.com\/helm\/${version}\/helm-${version}-linux-amd64.tar.gz\ntar -zxvf helm-${version}-linux-amd64.tar.gz\nmv linux-amd64\/helm \/usr\/local\/bin\/helm && rm -rf linux-amd64\n```\n所有节点安装longhorn依赖\n```shell\nyum install -y iscsi-initiator-utils\nsystemctl enable --now iscsid\n```\n添加longhorn chart，如果网络较差可以longhorn github release下载chart源码\n```shell\nhelm repo add longhorn https:\/\/charts.longhorn.io\nhelm repo update\n```\n\n部署longhorn，支持离线部署，需要提前推送镜像到私有仓库longhornio下\n```shell\nkubectl create namespace longhorn-system\n\nhelm install longhorn \\\n  --namespace longhorn-system \\\n  --set defaultSettings.defaultDataPath=\"\/data\/longhorn\/\" \\\n  --set defaultSettings.defaultReplicaCount=3 \\\n  --set service.ui.type=NodePort \\\n  --set service.ui.nodePort=30890 \\\n  #--set privateRegistry.registryUrl=10.39.140.196:8081 \\\n  longhorn\/longhorn\n```\n确认longhorn运行正常\n```shell\n[root@jenkins longhorn]# kubectl -n longhorn-system get pods\nNAME                                        READY   STATUS    RESTARTS   AGE\ncsi-attacher-58b856dcff-9kqdt               1\/1     Running   0          13h\ncsi-attacher-58b856dcff-c4zzp               1\/1     Running   0          13h\ncsi-attacher-58b856dcff-tvfw2               1\/1     Running   0          13h\ncsi-provisioner-56dd9dc55b-6ps8m            1\/1     Running   0          13h\ncsi-provisioner-56dd9dc55b-m7gz4            1\/1     Running   0          13h\ncsi-provisioner-56dd9dc55b-s9bh4            1\/1     Running   0          13h\ncsi-resizer-6b87c4d9f8-2skth                1\/1     Running   0          13h\ncsi-resizer-6b87c4d9f8-sqn2g                1\/1     Running   0          13h\ncsi-resizer-6b87c4d9f8-z6xql                1\/1     Running   0          13h\nengine-image-ei-b99baaed-5fd7m              1\/1     Running   0          13h\nengine-image-ei-b99baaed-jcjxj              1\/1     Running   0          12h\nengine-image-ei-b99baaed-n6wxc              1\/1     Running   0          12h\nengine-image-ei-b99baaed-qxfhg              1\/1     Running   0          12h\ninstance-manager-e-44ba7ac9                 1\/1     Running   0          12h\ninstance-manager-e-48676e4a                 1\/1     Running   0          12h\ninstance-manager-e-57bd994b                 1\/1     Running   0          12h\ninstance-manager-e-753c704f                 1\/1     Running   0          13h\ninstance-manager-r-4f4be1c1                 1\/1     Running   0          12h\ninstance-manager-r-68bfb49b                 1\/1     Running   0          12h\ninstance-manager-r-ccb87377                 1\/1     Running   0          12h\ninstance-manager-r-e56429be                 1\/1     Running   0          13h\nlonghorn-csi-plugin-fqgf7                   2\/2     Running   0          12h\nlonghorn-csi-plugin-gbrnf                   2\/2     Running   0          13h\nlonghorn-csi-plugin-kjj6b                   2\/2     Running   0          12h\nlonghorn-csi-plugin-tvbvj                   2\/2     Running   0          12h\nlonghorn-driver-deployer-74bb5c9fcb-khmbk   1\/1     Running   0          14h\nlonghorn-manager-82ztz                      1\/1     Running   0          12h\nlonghorn-manager-8kmsn                      1\/1     Running   0          12h\nlonghorn-manager-flmfl                      1\/1     Running   0          12h\nlonghorn-manager-mz6zj                      1\/1     Running   0          14h\nlonghorn-ui-77c6d6f5b7-nzsg2                1\/1     Running   0          14h\n```\n确认默认的storageclass已就绪\n```shell\n# kubectl get sc\nNAME                 PROVISIONER          RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nlonghorn (default)   driver.longhorn.io   Delete          Immediate           true                   14h\n```\n登录longhorn UI确认节点处于可调度状态\n\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/20200923132200912.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70#pic_center)\n\n\n\n## 部署kubesphere\n参考：\n\n[https:\/\/kubesphere.com.cn\/en\/docs\/installing-on-kubernetes\/](https:\/\/kubesphere.com.cn\/en\/docs\/installing-on-kubernetes\/)\n[https:\/\/github.com\/kubesphere\/ks-installer](https:\/\/github.com\/kubesphere\/ks-installer)\n\n部署kubesphere 3.0版本，下载yaml文件\n\n```shell\nwget https:\/\/raw.githubusercontent.com\/kubesphere\/ks-installer\/v3.0.0\/deploy\/kubesphere-installer.yaml\nwget https:\/\/raw.githubusercontent.com\/kubesphere\/ks-installer\/v3.0.0\/deploy\/cluster-configuration.yaml\n```\n修改cluster-configuration.yaml，找到相应字段开启需要安装的组件，以下仅为参考：\n```yaml\n  devops:\n    enabled: true\n    ......\n  logging:\n    enabled: true\n    ......\n  metrics_server:\n    enabled: true\n    ......\n  openpitrix:\n    enabled: true\n    ......\n```\n执行kubesphere部署\n```shell\nkubectl apply -f kubesphere-installer.yaml\nkubectl apply -f cluster-configuration.yaml\n```\n\n查看部署日志，确认无报错\n\n```shell\nkubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l app=ks-install -o jsonpath='{.items[0].metadata.name}') -f\n```\n\n部署完成后确认所有pod运行正常\n```shell\n[root@k8s-master1 ~]# kubectl get pods -A | grep kubesphere\nkubesphere-controls-system     default-http-backend-857d7b6856-q24v2                             1\/1     Running     0          12h\nkubesphere-controls-system     kubectl-admin-58f985d8f6-jl9bj                                    1\/1     Running     0          11h\nkubesphere-controls-system     kubesphere-router-demo-ns-6c97d4968b-njgrc                        1\/1     Running     1          154m\nkubesphere-devops-system       ks-jenkins-54455f5db8-hm6kc                                       1\/1     Running     0          11h\nkubesphere-devops-system       s2ioperator-0                                                     1\/1     Running     1          11h\nkubesphere-devops-system       uc-jenkins-update-center-cd9464fff-qnvfz                          1\/1     Running     0          12h\nkubesphere-logging-system      elasticsearch-logging-curator-elasticsearch-curator-160079hmdmb   0\/1     Completed   0          11h\nkubesphere-logging-system      elasticsearch-logging-data-0                                      1\/1     Running     0          12h\nkubesphere-logging-system      elasticsearch-logging-data-1                                      1\/1     Running     0          12h\nkubesphere-logging-system      elasticsearch-logging-discovery-0                                 1\/1     Running     0          12h\nkubesphere-logging-system      fluent-bit-c45h2                                                  1\/1     Running     0          12h\nkubesphere-logging-system      fluent-bit-kptfc                                                  1\/1     Running     0          12h\nkubesphere-logging-system      fluent-bit-rzjfp                                                  1\/1     Running     0          12h\nkubesphere-logging-system      fluent-bit-wztkp                                                  1\/1     Running     0          12h\nkubesphere-logging-system      fluentbit-operator-855d4b977d-fk6hs                               1\/1     Running     0          12h\nkubesphere-logging-system      ks-events-exporter-5bc4d9f496-x297f                               2\/2     Running     0          12h\nkubesphere-logging-system      ks-events-operator-8dbf7fccc-9qmml                                1\/1     Running     0          12h\nkubesphere-logging-system      ks-events-ruler-698b7899c7-fkn4l                                  2\/2     Running     0          12h\nkubesphere-logging-system      ks-events-ruler-698b7899c7-hw6rq                                  2\/2     Running     0          12h\nkubesphere-logging-system      logsidecar-injector-deploy-74c66bfd85-cxkxm                       2\/2     Running     0          12h\nkubesphere-logging-system      logsidecar-injector-deploy-74c66bfd85-lzxbm                       2\/2     Running     0          12h\nkubesphere-monitoring-system   alertmanager-main-0                                               2\/2     Running     0          11h\nkubesphere-monitoring-system   alertmanager-main-1                                               2\/2     Running     0          11h\nkubesphere-monitoring-system   alertmanager-main-2                                               2\/2     Running     0          11h\nkubesphere-monitoring-system   kube-state-metrics-95c974544-r8kmq                                3\/3     Running     0          12h\nkubesphere-monitoring-system   node-exporter-9ddxn                                               2\/2     Running     0          12h\nkubesphere-monitoring-system   node-exporter-dw929                                               2\/2     Running     0          12h\nkubesphere-monitoring-system   node-exporter-ht868                                               2\/2     Running     0          12h\nkubesphere-monitoring-system   node-exporter-nxdsm                                               2\/2     Running     0          12h\nkubesphere-monitoring-system   notification-manager-deployment-7c8df68d94-hv56l                  1\/1     Running     0          12h\nkubesphere-monitoring-system   notification-manager-deployment-7c8df68d94-ttdsg                  1\/1     Running     0          12h\nkubesphere-monitoring-system   notification-manager-operator-6958786cd6-pllgc                    2\/2     Running     0          12h\nkubesphere-monitoring-system   prometheus-k8s-0                                                  3\/3     Running     1          11h\nkubesphere-monitoring-system   prometheus-k8s-1                                                  3\/3     Running     1          11h\nkubesphere-monitoring-system   prometheus-operator-84d58bf775-5rqdj                              2\/2     Running     0          12h\nkubesphere-system              etcd-65796969c7-whbzx                                             1\/1     Running     0          12h\nkubesphere-system              ks-apiserver-b4dbcc67-2kknm                                       1\/1     Running     0          11h\nkubesphere-system              ks-apiserver-b4dbcc67-k6jr2                                       1\/1     Running     0          11h\nkubesphere-system              ks-apiserver-b4dbcc67-q8845                                       1\/1     Running     0          11h\nkubesphere-system              ks-console-786b9846d4-86hxw                                       1\/1     Running     0          12h\nkubesphere-system              ks-console-786b9846d4-l6mhj                                       1\/1     Running     0          12h\nkubesphere-system              ks-console-786b9846d4-wct8z                                       1\/1     Running     0          12h\nkubesphere-system              ks-controller-manager-7fd8799789-478ks                            1\/1     Running     0          11h\nkubesphere-system              ks-controller-manager-7fd8799789-hwgmp                            1\/1     Running     0          11h\nkubesphere-system              ks-controller-manager-7fd8799789-pdbch                            1\/1     Running     0          11h\nkubesphere-system              ks-installer-64ddc4b77b-c7qz8                                     1\/1     Running     0          12h\nkubesphere-system              minio-7bfdb5968b-b5v59                                            1\/1     Running     0          12h\nkubesphere-system              mysql-7f64d9f584-kvxcb                                            1\/1     Running     0          12h\nkubesphere-system              openldap-0                                                        1\/1     Running     0          12h\nkubesphere-system              openldap-1                                                        1\/1     Running     0          12h\nkubesphere-system              redis-ha-haproxy-5c6559d588-2rt6v                                 1\/1     Running     9          12h\nkubesphere-system              redis-ha-haproxy-5c6559d588-mhj9p                                 1\/1     Running     8          12h\nkubesphere-system              redis-ha-haproxy-5c6559d588-tgpjv                                 1\/1     Running     11         12h\nkubesphere-system              redis-ha-server-0                                                 2\/2     Running     0          12h\nkubesphere-system              redis-ha-server-1                                                 2\/2     Running     0          12h\nkubesphere-system              redis-ha-server-2                                                 2\/2     Running     0          12h\n```\n\n注意，kubesphere部分组件使用helm部署\n\n```shell\n[root@k8s-master1 ~]# helm ls -A | grep kubesphere\nelasticsearch-logging           kubesphere-logging-system       1               2020-09-23 00:49:08.526873742 +0800 CST deployed        elasticsearch-1.22.1            6.7.0-0217                  \nelasticsearch-logging-curator   kubesphere-logging-system       1               2020-09-23 00:49:16.117842593 +0800 CST deployed        elasticsearch-curator-1.3.3     5.5.4-0217                  \nks-events                       kubesphere-logging-system       1               2020-09-23 00:51:45.529430505 +0800 CST deployed        kube-events-0.1.0               0.1.0                       \nks-jenkins                      kubesphere-devops-system        1               2020-09-23 01:03:15.106022826 +0800 CST deployed        jenkins-0.19.0                  2.121.3-0217                \nks-minio                        kubesphere-system               2               2020-09-23 00:48:16.990599158 +0800 CST deployed        minio-2.5.16                    RELEASE.2019-08-07T01-59-21Z\nks-openldap                     kubesphere-system               1               2020-09-23 00:03:28.767712181 +0800 CST deployed        openldap-ha-0.1.0               1.0                         \nks-redis                        kubesphere-system               1               2020-09-23 00:03:19.439784188 +0800 CST deployed        redis-ha-3.9.0                  5.0.5                       \nlogsidecar-injector             kubesphere-logging-system       1               2020-09-23 00:51:57.519733074 +0800 CST deployed        logsidecar-injector-0.1.0       0.1.0                       \nnotification-manager            kubesphere-monitoring-system    1               2020-09-23 00:54:14.662762759 +0800 CST deployed        notification-manager-0.1.0      0.1.0                       \nuc                              kubesphere-devops-system        1               2020-09-23 00:51:37.885154574 +0800 CST deployed        jenkins-update-center-0.8.0     3.0.0    \n```\n\n获取web console 监听端口，默认为30880\n\n```shell\nkubectl get svc\/ks-console -n kubesphere-system\n```\n\n默认登录账号为\n\n```shell\nadmin\/P@88w0rd\n```\n登录kubesphere UI\n\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/202009231301350.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70#pic_center)\n集群节点信息\n\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/20200923130342758.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70#pic_center)\n服务组件信息\n\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/20200923130412386.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70#pic_center)\nlonghorn UI查看绑定的pv卷\n\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/2020092313235684.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70#pic_center)\n查看卷详情\n\n![在这里插入图片描述](https:\/\/img-blog.csdnimg.cn\/20200923132450281.png?x-oss-process=image\/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25ldHdvcmtlbg==,size_16,color_FFFFFF,t_70#pic_center)\n## 离线部署kubesphere\n1、准备harbor镜像仓库，镜像仓库地址：http:\/\/192.168.93.9\n\n2、下载kubesphere离线镜像包并解压\n```shell\ncurl -Ok https:\/\/kubesphere-installer.pek3b.qingstor.com\/offline\/v3.0.0\/kubesphere-all-v3.0.0-offline-linux-amd64.tar.gz\ntar -zxvf kubesphere-all-v3.0.0-offline-linux-amd64.tar.gz\n```\n3、推送镜像到harbor仓库\n\n下载脚本\n```shell\nwget https:\/\/raw.githubusercontent.com\/kubesphere\/ks-installer\/master\/scripts\/create_project_harbor.sh\n```\n修改create_project_harbor.sh脚本，指定镜像仓库地址和登录信息：\n```shell\nurl=\"http:\/\/192.168.93.9\"\nuser=\"admin\"\npasswd=\"Harbor12345\"\n```\n如果使用2.x版本harbor修改最后行为以下内容:\n```shell\n${url}\/api\/v2.0\/projects\n```\n创建项目\n```shell\nsh create_project_harbor.sh\n```\n\n推送镜像到私有镜像仓库\n```shell\ncd kubesphere-all-v3.0.0-offline-linux-amd64\/kubesphere-images-v3.0.0\nsh push-images.sh 192.168.93.9\n```\n\n3、部署kubesphere容器平台\n\n```shell\nhelm repo add test https:\/\/charts.kubesphere.io\/test\nhelm pull test\/ks-installer\ntar -zxvf ks-installer-0.2.1.tgz\n\nhelm install kubesphere \\\n  --namespace=kubesphere-system \\\n  --create-namespace \\\n  --set image.repository=192.168.93.9\/kubesphere\/ks-installer \\\n  --set image.tag=v3.0.0 \\\n  --set persistence.storageClass=longhorn \\\n  --set .registry=192.168.93.9 \\\n  .\/ks-installer\n```\n\n\n## 清理kubesphere集群\n参考：\n[https:\/\/kubesphere.com.cn\/en\/docs\/installing-on-kubernetes\/uninstalling\/uninstalling-kubesphere-from-k8s\/](https:\/\/kubesphere.com.cn\/en\/docs\/installing-on-kubernetes\/uninstalling\/uninstalling-kubesphere-from-k8s\/)\n\n```shell\nwget https:\/\/raw.githubusercontent.com\/kubesphere\/ks-installer\/master\/scripts\/kubesphere-delete.sh\nsh kubesphere-delete.sh\n```","meta":{"mtime":""}},"options":{}}
</script>

<script src="https://jsdelivr.topthink.com/npm/lodash@4.17/lodash.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react@17/umd/react.production.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react-dom@17/umd/react-dom.production.min.js"></script>

<script src="../asset/index.js"></script>

<script src="../asset/plugins/highlight/index.js"></script>

<script src="../asset/plugins/lunrjs/index.js"></script>

<script type="text/javascript">
    TopWrite.bootstrap();
</script>
</body>
</html>
